@model EndUsersPaginatedViewModel
@{
    ViewData["Title"] = "End Users Management";
}

@await Html.PartialAsync("_EndUsersHeader", Model)

@await Html.PartialAsync("_EndUsersStatistics", Model)

@await Html.PartialAsync("_EndUsersSearchForm", Model)

@await Html.PartialAsync("_EndUsersTable", Model)

@await Html.PartialAsync("_EndUsersModals")

@functions {
    public string GetPageUrl(int page)
    {
        var routeValues = new RouteValueDictionary
        {
            ["page"] = page,
            ["pageSize"] = Model.EndUsers.PageSize
        };

        if (!string.IsNullOrWhiteSpace(Model.SearchPhoneNumber))
            routeValues["searchPhoneNumber"] = Model.SearchPhoneNumber;

        return Url.Action("EndUsers", routeValues);
    }
}

@section Scripts {
    <script src="~/js/endusers-management.js"></script>
    <script src="~/js/user-modals.js"></script>
    <script src="~/js/playtomic-integration.js"></script>
    
    <script>
        // Configure URLs for the JavaScript files
        window.endUsersBaseUrl = '@Url.Action("EndUsers")';
    </script>
}
